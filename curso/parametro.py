def prueba(documento=''):
    filtro = '' if documento == '' else f' and nro_documento={documento}'
    query = f"SELECT ID, NRO_DOCUMENTO DOCUMENTO, OBJECTID, NEXUS_GIS.INFORMACION_ENREMTAT_DIN.CT_FROM_OBJECTID(OBJECTID) CT, CANT_AFECTACIONES AFECTADOS FROM (SELECT DISTINCT   D.ID, D.NAME NRO_DOCUMENTO, OB.OBJECTID, DECODE(DT.IS_FORCED, 0,'PROGRAMADO','FORZADO') ORIGEN, ARO.TIME AS FECHA_DOCUMENTO, DS.DESCRIPTION AS ESTADO, CASE WHEN D.LAST_STATE_ID>=5 THEN 0 ELSE AE.COUNT_PROPERTIES END CANT_AFECTACIONES, NVL(D.ESTIMATED_RESTORATION_TIME,ROUND(ARO.TIME + (4 / 24), 'HH24')) FECHA_NORM_PREVISTA, 'MT' SISTEMA , D.MODEL_ELEMENT_CHAIN CAD_ELECTRICA, 'MT FORZADA' MOTIVO , (SELECT FAILURE_TYPE_ID FROM NEXUS_GIS.OMS_DOCUMENT_CAUSE WHERE DOCUMENT_ID = D.ID) CAUSA , D.OWNER_GROUP FROM   NEXUS_GIS.OMS_DOCUMENT D, NEXUS_GIS.OMS_OPERATION OP, NEXUS_GIS.OMS_DOCUMENT_TYPE DT, NEXUS_GIS.OMS_DOCUMENT_STATE DS, NEXUS_GIS.SPRGOPERATIONS SO, NEXUS_GIS.OMS_AFFECT_RESTORE_OPERATION ARO, NEXUS_GIS.OMS_AFFECTED_ELEMENT AE , NEXUS_GIS.SPROBJECTS OB WHERE 1=1 AND D.ID = OP.DOCUMENT_ID AND D.TYPE_ID = DT.ID AND D.LAST_STATE_ID = DS.ID AND OP.OPERATION_MODEL_ID = SO.OPERATIONID AND OP.ID = ARO.OPERATION_ID AND ARO.ID = AE.AFFECT_ID AND AE.ELEMENT_ID = OB.OBJECTID AND SO.LOGIDTO = 0 AND D.LAST_STATE_ID IN (2,3,4) AND (D.NOTES NOT LIKE '%revisado..%' OR D.NOTES IS NULL) AND ((SYSDATE - ARO.TIME) * (60 * 24))>=10 AND (SELECT COUNT(1) FROM NEXUS_GIS.TABLA_ENREMTAT_DET WHERE ELEMENT_ID=OB.OBJECTID AND CANT_AFECTACIONES>0)=0 AND ARO.IS_RESTORE = 0 AND D.TYPE_ID IN (3) AND AE.COUNT_PROPERTIES>0 AND (SELECT COUNT(1) FROM NEXUS_GIS.TABLA_ENREMTAT_DET WHERE ID=D.ID)=0 AND AE.AFFECT_ID =(SELECT MAX(AFFECT_ID) FROM NEXUS_GIS.OMS_AFFECTED_ELEMENT AE1, NEXUS_GIS.OMS_AFFECT_RESTORE_OPERATION RO WHERE AE1.AFFECT_ID = RO.ID AND RO.DOCUMENT_ID = D.ID AND AE1.ELEMENT_ID = AE.ELEMENT_ID) ORDER BY 1 ){filtro}"
    print(query)
    
prueba('')